<h1>Welcome to your task page, <%=current_user.username%></h1>

<% @tasks.each do |task| %>

<h1> <%= task.taskname %> <%= "- Completed" if task.completed %> </h1>
  <% if task.completed %>
    <form method="post" action="/tasks/<%=task.id%>/uncompleted">

      <input type="submit" value="Mark Uncompleted">
    </form>
  <% else %>
    <form method="post" action="/tasks/<%=task.id%>/completed">
      <input type="submit" value="Mark Completed">
    </form>
  <% end %>

  <form method="post" action="/tasks/<%=task.id%>">
    <input type="hidden" id="hidden" name="_method" value="patch">
    <label>Change your name: <input type="text" value="<%=task.taskname%>" name="taskname"> </label>
    <input type="submit" value="submit">
  </form>

  <form method="post" action="/tasks/<%=task.id%>/delete">
    <input type="hidden" id="hidden" name="_method" value="delete">
    <h4> Click this button to delete this task! </h4>
    <input type="submit" value="delete">
  </form>

  <h3> Subtasks </h3>
  <% task.subtasks.each do |subtask| %>
    <h4><%= subtask.details%> <%="- Completed" if subtask.completed %></h4>
    <form method="post" action="/subtasks/<%=subtask.id%>/delete">
      <input type="hidden" id="hidden" name="_method" value="delete">
      <input type="submit" value="Delete Subtask Above">
    </form>
    <% if subtask.completed %>
      <form method="post" action="/subtasks/<%=subtask.id%>/uncompleted">
        <input type="submit" value="Mark Subtask Uncompleted">
      </form>
    <% else %>
      <form method="post" action="/subtasks/<%=subtask.id%>/completed">
        <input type="submit" value="Mark Subtask Completed">
      </form>
    <% end %>
  <% end %>

  <h3> Create a new subtask! </h3>

  <form method="post" action="/subtasks">
    <input type="hidden" name="task_id" value="<%=task.id%>">
    <input type="text" name="subtask[details]">
    <input type="submit" value="Create New Subtask">
  </form>

<% end %>

<h1>Create a new task!</h1>
<form method="post" action="/tasks">

  <label>Task: <input type="text" name="task[taskname]"></label>

  <label>Subtask: <input type="text" name="subtask[][details]"></label>
  <label>Subtask: <input type="text" name="subtask[][details]"></label>
  <label>Subtask: <input type="text" name="subtask[][details]"></label>

  <input type="submit" type="submit">

</form>
